<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏™‡∏Å‡∏£. v7</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a5f7a;
            --primary-light: #2e86ab;
            --primary-dark: #0d3d4f;
            --accent: #e65100;
            --accent-light: #ff8a50;
            --success: #2e7d32;
            --success-light: #4caf50;
            --selected-bg: #c8e6c9;
            --selected-border: #2e7d32;
            --bg-cream: #faf6f0;
            --text-dark: #1a1a1a;
            --text-muted: #666666;
            --border: #e0d5c7;
            --shadow: rgba(26, 95, 122, 0.12);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body {
            font-family: 'Prompt', 'Kanit', sans-serif;
            background: var(--bg-cream);
            height: 100%;
            color: var(--text-dark);
            overflow: hidden;
        }

        /* HEADER */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 5px 12px;
            position: fixed;
            top: 0; left: 0; right: 0;
            z-index: 100;
            box-shadow: 0 2px 10px var(--shadow);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header h1 {
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .header-select {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 20px;
        }

        .header-select label {
            font-size: 0.6rem;
            opacity: 0.9;
            white-space: nowrap;
        }

        .header-select input {
            padding: 4px 8px;
            border-radius: 4px;
            border: none;
            font-size: 0.6rem;
            width: 200px;
            font-family: inherit;
        }

        .header-select input::placeholder {
            color: #999;
        }

        .header-center {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .view-toggle-header {
            display: flex;
            gap: 2px;
            background: rgba(255,255,255,0.2);
            padding: 2px;
            border-radius: 4px;
        }

        .view-btn-h {
            padding: 3px 8px;
            border: none;
            background: transparent;
            color: white;
            cursor: pointer;
            font-size: 0.55rem;
            border-radius: 3px;
        }

        .view-btn-h.active {
            background: rgba(255,255,255,0.3);
        }

        .progress-badge {
            background: rgba(255,255,255,0.15);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.65rem;
        }

        .progress-badge strong {
            color: var(--accent-light);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-header {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 500;
            cursor: pointer;
            border: none;
        }

        .btn-add { background: rgba(76, 175, 80, 0.8); color: white; }
        .btn-clear { background: rgba(244, 67, 54, 0.7); color: white; }
        .btn-submit { background: var(--success); color: white; }
        .btn-submit:disabled { background: rgba(255,255,255,0.3); cursor: not-allowed; }

        /* MAIN CONTAINER - FIXED */
        .main-container {
            display: flex;
            position: fixed;
            top: 38px;
            left: 0; right: 0; bottom: 0;
            overflow: hidden;
        }

        /* LEFT SIDEBAR */
        .left-sidebar {
            width: 170px;
            min-width: 170px;
            background: white;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border);
        }

        .left-sidebar.collapsed {
            width: 32px;
            min-width: 32px;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 4px 6px;
            border-bottom: 2px solid var(--primary);
            background: var(--bg-cream);
        }

        .sidebar-title {
            font-size: 0.65rem;
            font-weight: 600;
            color: var(--primary);
        }

        .left-sidebar.collapsed .sidebar-title span { display: none; }

        .sidebar-toggle {
            width: 18px; height: 18px;
            border: none;
            background: var(--primary);
            color: white;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.55rem;
        }

        .ranking-list {
            flex: 1;
            overflow-y: auto;
            padding: 3px;
        }

        .left-sidebar.collapsed .ranking-list { display: none; }

        .ranking-slot {
            display: flex;
            align-items: center;
            gap: 2px;
            padding: 2px 3px;
            background: #f5f5f5;
            border-radius: 3px;
            min-height: 20px;
            margin-bottom: 2px;
            border: 1px dashed var(--border);
            cursor: grab;
        }

        .ranking-slot.filled {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
            border: none;
            color: white;
        }

        .ranking-slot.drag-over {
            border: 2px solid var(--accent);
        }

        .ranking-number {
            width: 14px; height: 14px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.45rem;
        }

        .ranking-slot.filled .ranking-number {
            background: rgba(255,255,255,0.25);
        }

        .ranking-content {
            flex: 1;
            font-size: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: var(--text-muted);
        }

        .ranking-slot.filled .ranking-content {
            color: white;
        }

        .ranking-remove {
            width: 12px; height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.45rem;
        }

        .ranking-slot.filled .ranking-remove { display: flex; }
        .ranking-remove:hover { background: rgba(255,0,0,0.5); }

        .sidebar-footer {
            padding: 5px;
            border-top: 1px solid var(--border);
            background: var(--bg-cream);
            font-size: 0.42rem;
            color: var(--text-muted);
            line-height: 1.35;
        }

        .sidebar-footer strong {
            color: var(--primary);
            font-size: 0.45rem;
        }

        .sidebar-footer .section-title {
            margin-top: 4px;
        }

        .left-sidebar.collapsed .sidebar-footer { display: none; }

        .collapsed-info {
            display: none;
            writing-mode: vertical-rl;
            font-size: 0.5rem;
            color: var(--primary);
            font-weight: 600;
            padding: 6px 0;
            text-align: center;
        }

        .left-sidebar.collapsed .collapsed-info { display: block; }

        /* RIGHT PANEL */
        .right-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* FILTER BAR */
        .filter-bar {
            background: white;
            padding: 4px 6px;
            display: flex;
            align-items: center;
            gap: 5px;
            border-bottom: 1px solid var(--border);
        }

        .search-box {
            width: 140px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 3px 5px 3px 22px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.6rem;
        }

        .search-box::before {
            content: "üîç";
            position: absolute;
            left: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.55rem;
        }

        .filter-scroll-container {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 3px;
            overflow: hidden;
        }

        .scroll-btn {
            width: 18px; height: 18px;
            border: none;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .filter-scroll {
            flex: 1;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .filter-scroll::-webkit-scrollbar { display: none; }

        .category-tabs {
            display: flex;
            gap: 3px;
        }

        .category-tab {
            padding: 2px 7px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            font-size: 0.55rem;
            white-space: nowrap;
        }

        .category-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* COURSE LIST */
        .course-list-container {
            flex: 1;
            overflow-y: auto;
            padding: 5px;
        }

        .category-section {
            margin-bottom: 8px;
        }

        .category-header {
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 0.75rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 5;
        }

        .category-header.cat-1a { background: linear-gradient(135deg, #d84315 0%, #e64a19 100%); }
        .category-header.cat-1a-np { background: linear-gradient(135deg, #6d4c41 0%, #8d6e63 100%); }
        .category-header.cat-1a-jd { background: linear-gradient(135deg, #f57c00 0%, #ff9800 100%); }
        .category-header.cat-1b { background: linear-gradient(135deg, #c2185b 0%, #e91e63 100%); }
        .category-header.cat-1c { background: linear-gradient(135deg, #7b1fa2 0%, #9c27b0 100%); }
        .category-header.cat-2a { background: linear-gradient(135deg, #1565c0 0%, #1e88e5 100%); }
        .category-header.cat-2b { background: linear-gradient(135deg, #00838f 0%, #00acc1 100%); }
        .category-header.cat-3 { background: linear-gradient(135deg, #2e7d32 0%, #43a047 100%); }
        .category-header.cat-4a { background: linear-gradient(135deg, #ef6c00 0%, #fb8c00 100%); }
        .category-header.cat-4b { background: linear-gradient(135deg, #5d4037 0%, #795548 100%); }
        .category-header.cat-5 { background: linear-gradient(135deg, #33691e 0%, #558b2f 100%); }
        .category-header.cat-6 { background: linear-gradient(135deg, #c62828 0%, #e53935 100%); }
        .category-header.cat-7 { background: linear-gradient(135deg, #212121 0%, #424242 100%); }
        .category-header.cat-8 { background: linear-gradient(135deg, #1976d2 0%, #42a5f5 100%); }
        .category-header.cat-9 { background: linear-gradient(135deg, #7b1fa2 0%, #ab47bc 100%); }
        .category-header.cat-10 { background: linear-gradient(135deg, #455a64 0%, #607d8b 100%); }
        .category-header.cat-11 { background: linear-gradient(135deg, #b71c1c 0%, #c62828 100%); }

        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(155px, 1fr));
            gap: 4px;
        }

        body.compact-mode .course-grid {
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 3px;
        }

        .course-card {
            background: #f8f8f8;
            border-radius: 4px;
            padding: 3px 5px;
            border: 2px solid transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            min-height: 28px;
            position: relative;
        }

        body.compact-mode .course-card {
            padding: 2px 4px;
            min-height: 24px;
            gap: 3px;
        }

        .course-card:hover {
            border-color: var(--primary-light);
            background: white;
        }

        .course-card.selected {
            border-color: var(--selected-border);
            background: var(--selected-bg);
        }

        /* Badge ‡∏ï‡∏¥‡πä‡∏Å‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
        .course-card.selected::before {
            content: "‚úì";
            position: absolute;
            top: -5px; left: -5px;
            width: 16px; height: 16px;
            background: var(--success);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.5rem;
            font-weight: bold;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        /* Badge ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏µ‡∏™‡πâ‡∏° */
        .course-card.selected::after {
            content: attr(data-rank);
            position: absolute;
            top: -5px; right: -5px;
            min-width: 16px; height: 16px;
            padding: 0 3px;
            background: var(--accent);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.45rem;
            font-weight: bold;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .course-card.selected .course-id {
            background: var(--success);
        }

        .course-id {
            min-width: 22px; height: 22px;
            border-radius: 3px;
            background: var(--primary);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.55rem;
            line-height: 1;
        }

        body.compact-mode .course-id {
            min-width: 18px; height: 18px;
            font-size: 0.5rem;
        }

        .source-tag {
            font-size: 0.3rem;
            padding: 0 2px;
            border-radius: 2px;
            margin-top: 1px;
        }

        .source-tag.skr { background: rgba(255,255,255,0.3); color: white; }
        .source-tag.social { background: var(--accent); color: white; }

        .course-name {
            flex: 1;
            font-size: 0.55rem;
            font-weight: 500;
            line-height: 1.2;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            min-width: 0;
        }

        body.compact-mode .course-name {
            font-size: 0.5rem;
        }

        .rank-dropdown {
            width: 24px;
            padding: 1px;
            border: 1px solid var(--border);
            border-radius: 3px;
            font-size: 0.5rem;
            background: white;
            cursor: pointer;
            text-align: center;
        }

        body.compact-mode .rank-dropdown {
            width: 20px;
            font-size: 0.45rem;
        }

        .course-card.selected .rank-dropdown {
            border-color: var(--success);
            font-weight: 600;
        }

        /* TOOLTIP */
        .tooltip {
            position: fixed;
            background: var(--text-dark);
            color: white;
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 0.6rem;
            z-index: 1000;
            max-width: 280px;
            pointer-events: none;
            display: none;
        }

        .tooltip.show { display: block; }

        /* MODAL */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-overlay.show { display: flex; }

        .modal-content {
            background: white;
            border-radius: 10px;
            padding: 16px;
            width: 90%;
            max-width: 380px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .modal-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary);
        }

        .modal-close {
            width: 24px; height: 24px;
            border: none;
            background: var(--bg-cream);
            border-radius: 50%;
            cursor: pointer;
        }

        .custom-input-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .custom-input-row {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .custom-input-row span {
            width: 16px;
            text-align: center;
            font-weight: 600;
            color: var(--primary);
            font-size: 0.75rem;
        }

        .custom-input-row input {
            flex: 1;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 5px;
            font-size: 0.75rem;
        }

        .custom-input-row input.error {
            border-color: #f44336;
            background: #ffebee;
        }

        .modal-footer {
            margin-top: 14px;
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }

        .modal-btn {
            padding: 8px 16px;
            border-radius: 5px;
            font-size: 0.75rem;
            cursor: pointer;
            border: none;
        }

        .modal-btn.cancel { background: var(--bg-cream); }
        .modal-btn.save { background: var(--primary); color: white; }

        /* TOAST */
        .toast {
            position: fixed;
            bottom: 20px; right: 20px;
            background: var(--primary);
            color: white;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 0.7rem;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show { transform: translateY(0); opacity: 1; }
        .toast.success { background: var(--success); }
        .toast.warning { background: var(--accent); }
        .toast.error { background: #d32f2f; }

        /* LOADING */
        .loading-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .loading-overlay.show { display: flex; }

        .loading-content {
            background: white;
            padding: 24px 40px;
            border-radius: 10px;
            text-align: center;
        }

        .spinner {
            width: 32px; height: 32px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: #f0f0f0; }
        ::-webkit-scrollbar-thumb { background: var(--primary-light); border-radius: 4px; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <h1>üìã ‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° ‡∏™‡∏Å‡∏£.</h1>
                <div class="header-select">
                    <label>‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏° (‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î):</label>
                    <input type="text" id="centerSearch" list="centerList" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å...">
                    <datalist id="centerList">
                        <option value="‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏£‡∏∞‡∏¢‡∏≤‡∏õ‡πà‡∏≤‡∏™‡∏±‡∏Å (‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ)">
                        <option value="‡∏•‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏£‡∏∞‡∏¢‡∏≤ (‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ)">
                        <option value="‡∏ó‡πà‡∏≤‡∏à‡∏µ‡∏ô‡∏ñ‡∏¥‡πà‡∏ô‡πÅ‡∏°‡πà‡∏Å‡∏•‡∏≠‡∏á (‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ)">
                        <option value="‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå)">
                        <option value="‡∏≠‡πà‡∏≤‡∏ß‡πÑ‡∏ó‡∏¢ (‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä)">
                        <option value="‡∏≠‡∏±‡∏ô‡∏î‡∏≤‡∏°‡∏±‡∏ô (‡∏û‡∏±‡∏á‡∏á‡∏≤)">
                        <option value="‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ (‡∏™‡∏ï‡∏π‡∏•)">
                        <option value="‡πÄ‡∏ö‡∏ç‡∏à‡∏ö‡∏π‡∏£‡∏û‡∏≤ (‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ)">
                        <option value="‡∏™‡∏∏‡∏î‡∏ù‡∏±‡πà‡∏á‡∏ö‡∏π‡∏£‡∏û‡∏≤ (‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ)">
                        <option value="‡∏†‡∏π‡∏ò‡∏≤‡∏ô‡∏µ (‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ)">
                        <option value="‡∏™‡∏ô‡∏° (‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£)">
                        <option value="‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏Å‡πà‡∏ô‡∏™‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå (‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°)">
                        <option value="‡∏ô‡∏Ñ‡∏£‡∏ä‡∏±‡∏¢‡∏ö‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå (‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤)">
                        <option value="‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏£‡∏Å‡∏ï (‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ)">
                        <option value="‡∏´‡∏•‡πà‡∏≤‡∏¢‡∏î‡∏≠‡∏¢ (‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà)">
                        <option value="‡∏≠‡∏¥‡∏á‡∏î‡∏≠‡∏¢ (‡∏û‡∏∞‡πÄ‡∏¢‡∏≤)">
                        <option value="‡∏´‡πâ‡∏≤‡∏Ç‡∏∏‡∏ô‡∏®‡∏∂‡∏Å (‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå)">
                        <option value="‡∏≠‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏ß‡∏≠‡∏π‡πà‡∏ô‡πâ‡∏≥ (‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå)">
                    </datalist>
                </div>
            </div>
            <div class="header-center">
                <div class="view-toggle-header">
                    <button class="view-btn-h active" id="viewNormal">‡∏õ‡∏Å‡∏ï‡∏¥</button>
                    <button class="view-btn-h" id="viewCompact">‡∏Å‡∏∞‡∏ó‡∏±‡∏î‡∏£‡∏±‡∏î</button>
                </div>
                <div class="progress-badge">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å <strong id="selectedCount">0</strong>/20</div>
            </div>
            <div class="header-right">
                <button class="btn-header btn-add" id="addCourseBtn">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤</button>
                <button class="btn-header btn-clear" id="btnClear">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á</button>
                <button class="btn-header btn-submit" id="btnSubmit" disabled>‚úì ‡∏™‡πà‡∏á</button>
            </div>
        </div>
    </header>

    <main class="main-container">
        <aside class="left-sidebar" id="leftSidebar">
            <div class="sidebar-header">
                <span class="sidebar-title">üèÜ <span>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span></span>
                <button class="sidebar-toggle" id="sidebarToggle">‚â°</button>
            </div>
            <div class="collapsed-info" id="collapsedInfo">0/20</div>
            <div class="ranking-list" id="rankingList"></div>
            <div class="sidebar-footer">
                <strong>üìñ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:</strong><br>
                ‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö<br>
                ‚Ä¢ ‡∏•‡∏≤‡∏Å (Drag) ‡∏ß‡∏¥‡∏ä‡∏≤‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á<br>
                ‚Ä¢ ‡∏•‡∏≤‡∏Å‡∏™‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö / ‡∏Å‡∏î ‚úï ‡∏•‡∏ö<br>
                ‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ 5 ‡∏ß‡∏¥‡∏ä‡∏≤<br>
                <strong class="section-title">üìã ‡∏Ñ‡∏≥‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á:</strong><br>
                ‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 20<br>
                ‚Ä¢ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1 = ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î<br>
                ‚Ä¢ ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 8 ‡∏ß‡∏¥‡∏ä‡∏≤
            </div>
        </aside>

        <div class="right-panel">
            <div class="filter-bar">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
                </div>
                <div class="filter-scroll-container">
                    <button class="scroll-btn" id="scrollLeft">‚óÄ</button>
                    <div class="filter-scroll" id="filterScroll">
                        <div class="category-tabs" id="categoryTabs">
                            <button class="category-tab active" data-category="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            <button class="category-tab" data-category="cat-1a">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏≤‡∏ß</button>
                            <button class="category-tab" data-category="cat-1a-np">‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å</button>
                            <button class="category-tab" data-category="cat-1a-jd">‡∏à‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</button>
                            <button class="category-tab" data-category="cat-1b">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ß‡πà‡∏≤‡∏á</button>
                            <button class="category-tab" data-category="cat-1c">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</button>
                            <button class="category-tab" data-category="cat-2a">‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</button>
                            <button class="category-tab" data-category="cat-2b">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏≠‡∏¥‡∏™‡∏£‡∏∞</button>
                            <button class="category-tab" data-category="cat-3">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</button>
                            <button class="category-tab" data-category="cat-4a">AI</button>
                            <button class="category-tab" data-category="cat-4b">‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</button>
                            <button class="category-tab" data-category="cat-5">‡πÄ‡∏Å‡∏©‡∏ï‡∏£</button>
                            <button class="category-tab" data-category="cat-6">Delivery</button>
                            <button class="category-tab" data-category="cat-7">TikTok</button>
                            <button class="category-tab" data-category="cat-8">Google</button>
                            <button class="category-tab" data-category="cat-9">AI ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</button>
                            <button class="category-tab" data-category="cat-10">‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á</button>
                            <button class="category-tab" data-category="cat-11">‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</button>
                        </div>
                    </div>
                    <button class="scroll-btn" id="scrollRight">‚ñ∂</button>
                </div>
            </div>
            <div class="course-list-container" id="courseListContainer"></div>
        </div>
    </main>

    <div class="tooltip" id="tooltip"></div>

    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏á (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5)</h3>
                <button class="modal-close" id="modalClose">‚úï</button>
            </div>
            <div class="custom-input-list">
                <div class="custom-input-row"><span>1</span><input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c1"></div>
                <div class="custom-input-row"><span>2</span><input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c2"></div>
                <div class="custom-input-row"><span>3</span><input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c3"></div>
                <div class="custom-input-row"><span>4</span><input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c4"></div>
                <div class="custom-input-row"><span>5</span><input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c5"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" id="modalCancel">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="modal-btn save" id="modalSave">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
        </div>
    </div>

    <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzBs65btqoU2unyOykwQjrsC2GiaYG8b0aQ-9LZa1rS6RQ61xAjWBLUnTSaHRHyXPVeoA/exec';

        const searchAliases = {
            '‡∏ï‡∏¥‡πä‡∏Å‡∏ï‡∏≠‡∏Å': 'tiktok', '‡∏ï‡∏¥‡∏Å‡∏ï‡∏≠‡∏Å': 'tiktok', 'tiktok': 'tiktok',
            '‡πÑ‡∏•‡∏ô‡πå': 'line', 'line': 'line',
            '‡πÄ‡∏ü‡∏ã‡∏ö‡∏∏‡πä‡∏Å': 'facebook', '‡πÄ‡∏ü‡∏™‡∏ö‡∏∏‡∏Ñ': 'facebook', 'facebook': 'facebook',
            '‡∏¢‡∏π‡∏ó‡∏π‡∏õ': 'youtube', 'youtube': 'youtube',
            '‡∏Å‡∏π‡πÄ‡∏Å‡∏¥‡∏•': 'google', 'google': 'google',
            '‡∏ä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ': 'shopee', 'shopee': 'shopee',
            '‡∏•‡∏≤‡∏ã‡∏≤‡∏î‡πâ‡∏≤': 'lazada', 'lazada': 'lazada',
            '‡πÅ‡∏Å‡∏£‡πá‡∏ö': 'grab', 'grab': 'grab',
            '‡πÅ‡∏ä‡∏ó‡∏à‡∏µ‡∏û‡∏µ‡∏ó‡∏µ': 'chatgpt', 'chatgpt': 'chatgpt',
            '‡πÅ‡∏Ñ‡∏ô‡∏ß‡∏≤': 'canva', 'canva': 'canva',
            '‡πÄ‡∏≠‡πÑ‡∏≠': 'ai', 'ai': 'ai'
        };

        const courses = [
            { id: 1, name: "‡πÅ‡∏Å‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡πÑ‡∏Å‡πà‡∏°‡πâ‡∏ß‡∏ô‡∏Å‡∏±‡∏ö‡πÅ‡∏´‡πâ‡∏ß‡∏à‡∏µ‡∏ô", category: "cat-1a", source: "‡∏™‡∏Å‡∏£." },
            { id: 2, name: "‡∏ï‡πâ‡∏°‡∏™‡πâ‡∏°‡∏õ‡∏•‡∏≤‡πÅ‡∏£‡∏î", category: "cat-1a", source: "‡∏™‡∏Å‡∏£." },
            { id: 3, name: "‡πÅ‡∏Å‡∏á‡∏™‡∏≤‡∏°‡∏£‡∏™", category: "cat-1a", source: "‡∏™‡∏Å‡∏£." },
            { id: 4, name: "‡∏¢‡∏≥‡∏ñ‡∏±‡πà‡∏ß‡∏á‡∏≠‡∏Å", category: "cat-1a", source: "‡∏™‡∏Å‡∏£." },
            { id: 5, name: "‡∏õ‡∏•‡∏≤‡∏Å‡∏∞‡∏û‡∏á‡∏°‡πâ‡∏ß‡∏ô", category: "cat-1a", source: "‡∏™‡∏Å‡∏£." },
            { id: 6, name: "‡πÅ‡∏Å‡∏á‡πÄ‡∏´‡∏á‡∏≤‡∏´‡∏á‡∏≠‡∏î", category: "cat-1a", source: "‡∏™‡∏Å‡∏£." },
            { id: 7, name: "‡∏¢‡∏≥‡∏™‡∏ï‡∏£‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡∏µ‡πà‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏á‡∏≤‡∏°‡πà‡∏≠‡∏ô", category: "cat-1a", source: "‡∏™‡∏Å‡∏£." },
            { id: 8, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏õ‡∏•‡∏≤‡πÅ‡∏Å‡∏∞ (Fish Rice)", category: "cat-1a", source: "Social" },
            { id: 9, name: "‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏≠‡∏ö‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡πà‡∏¢‡∏°", category: "cat-1a", source: "Social" },
            { id: 10, name: "‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡∏ó‡∏∞‡πÄ‡∏•/‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡∏ñ‡∏≤‡∏î", category: "cat-1a", source: "Social" },
            { id: 11, name: "‡πÑ‡∏Å‡πà‡∏Å‡∏£‡∏≠‡∏ö‡∏ã‡∏≠‡∏™‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ", category: "cat-1a", source: "Social" },
            { id: 12, name: "‡∏õ‡∏µ‡∏Å‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î‡∏Ñ‡∏•‡∏∏‡∏Å‡∏ú‡∏á", category: "cat-1a", source: "Social" },
            { id: 13, name: "‡∏´‡∏°‡∏µ‡πà‡∏Ñ‡∏•‡∏∏‡∏Å/‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏Ñ‡∏•‡∏∏‡∏Å", category: "cat-1a", source: "Social" },
            { id: 14, name: "‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å", category: "cat-1a", source: "Social" },
            { id: 15, name: "Salmon Rice/‡∏Ç‡πâ‡∏≤‡∏ß‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô", category: "cat-1a", source: "Social" },
            { id: 16, name: "‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏ä‡πà‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤ (‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏à‡πâ‡∏≤‡∏î‡∏±‡∏á)", category: "cat-1a", source: "Social" },
            { id: 17, name: "‡πÅ‡∏Å‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡∏™‡∏π‡∏ï‡∏£‡∏î‡∏≤‡∏£‡∏≤", category: "cat-1a", source: "Social" },
            { id: 18, name: "‡πÑ‡∏Ç‡πà‡∏û‡∏∞‡πÇ‡∏•‡πâ‡∏™‡∏π‡∏ï‡∏£‡∏î‡∏≤‡∏£‡∏≤", category: "cat-1a", source: "Social" },
            { id: 19, name: "‡∏´‡∏°‡∏π‡∏õ‡∏¥‡πâ‡∏á‡∏™‡∏π‡∏ï‡∏£‡∏õ‡∏•‡∏≤‡∏£‡πâ‡∏≤/‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å", category: "cat-1a", source: "Social" },
            { id: 20, name: "‡∏°‡∏≤‡∏°‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", category: "cat-1a", source: "Social" },
            { id: 21, name: "‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡∏π‡∏ï‡∏£‡∏î‡∏≤‡∏£‡∏≤", category: "cat-1a", source: "Social" },
            { id: 22, name: "‡∏´‡∏°‡∏π‡∏ó‡∏≠‡∏î‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤", category: "cat-1a", source: "Social" },
            { id: 23, name: "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡πÄ‡∏ú‡∏≤‡∏õ‡∏•‡∏≤‡πÅ‡∏£‡∏î‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", category: "cat-1a-np", source: "‡∏™‡∏Å‡∏£." },
            { id: 24, name: "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏õ‡∏•‡∏≤‡∏£‡πâ‡∏≤‡∏•‡∏∏‡∏¢‡∏™‡∏ß‡∏ô", category: "cat-1a-np", source: "‡∏™‡∏Å‡∏£." },
            { id: 25, name: "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏°‡∏∞‡∏™‡∏±‡∏á", category: "cat-1a-np", source: "‡∏™‡∏Å‡∏£." },
            { id: 26, name: "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏ú‡∏±‡∏Å‡∏ä‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏ó‡πâ‡∏≤‡∏ß", category: "cat-1a-np", source: "‡∏™‡∏Å‡∏£." },
            { id: 27, name: "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡πÉ‡∏ö‡∏ä‡∏≤‡∏á‡∏≤‡∏°‡πà‡∏≠‡∏ô", category: "cat-1a-np", source: "‡∏™‡∏Å‡∏£." },
            { id: 28, name: "‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡πÇ‡∏ö‡∏£‡∏≤‡∏ì", category: "cat-1a-jd", source: "‡∏™‡∏Å‡∏£." },
            { id: 29, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ï‡πâ‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", category: "cat-1a-jd", source: "‡∏™‡∏Å‡∏£." },
            { id: 30, name: "‡∏´‡∏°‡∏µ‡πà‡∏Å‡∏∞‡∏ó‡∏¥", category: "cat-1a-jd", source: "‡∏™‡∏Å‡∏£." },
            { id: 31, name: "‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ô‡πÅ‡∏´‡πâ‡∏á", category: "cat-1a-jd", source: "‡∏™‡∏Å‡∏£." },
            { id: 32, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏°‡∏±‡∏ô‡∏™‡πâ‡∏°‡∏ï‡∏≥", category: "cat-1a-jd", source: "‡∏™‡∏Å‡∏£." },
            { id: 33, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å", category: "cat-1a-jd", source: "‡∏™‡∏Å‡∏£." },
            { id: 34, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡πÅ‡∏Å‡∏á‡∏Å‡∏∞‡∏´‡∏£‡∏µ‡πà‡πÇ‡∏Æ‡∏°‡πÄ‡∏°‡∏î", category: "cat-1a-jd", source: "Social" },
            { id: 35, name: "‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ö‡∏´‡∏°‡∏π", category: "cat-1b", source: "‡∏™‡∏Å‡∏£." },
            { id: 36, name: "‡∏´‡∏°‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏ö‡πÇ‡∏ö‡∏£‡∏≤‡∏ì", category: "cat-1b", source: "‡∏™‡∏Å‡∏£." },
            { id: 37, name: "‡∏Ç‡∏ô‡∏°‡∏ä‡πà‡∏≠‡∏°‡πà‡∏ß‡∏á‡∏à‡∏µ‡∏ö‡∏ô‡∏Å", category: "cat-1b", source: "‡∏™‡∏Å‡∏£." },
            { id: 38, name: "‡∏à‡∏∏‡πã‡∏¢‡∏Å‡πä‡∏ß‡∏¢‡∏ó‡∏£‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á", category: "cat-1b", source: "‡∏™‡∏Å‡∏£." },
            { id: 39, name: "‡∏°‡∏±‡∏ô‡∏ù‡∏£‡∏±‡πà‡∏á‡∏ö‡∏î‡∏ó‡∏≠‡∏î", category: "cat-1b", source: "‡∏™‡∏Å‡∏£." },
            { id: 40, name: "‡∏ú‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏ó‡πâ‡∏≠‡∏ô", category: "cat-1b", source: "‡∏™‡∏Å‡∏£." },
            { id: 41, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ï‡∏±‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏°‡∏•‡πá‡∏î‡∏ä‡∏≤", category: "cat-1b", source: "‡∏™‡∏Å‡∏£." },
            { id: 42, name: "‡∏Ç‡∏ô‡∏°‡∏Ñ‡∏£‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÑ‡∏Ç‡πà", category: "cat-1b", source: "Social" },
            { id: 43, name: "‡πÅ‡∏ã‡∏ô‡∏ß‡∏¥‡∏ä / ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡∏õ‡∏¥‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", category: "cat-1b", source: "Social" },
            { id: 44, name: "‡πÄ‡∏Ñ‡πâ‡∏Å‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏´‡∏≠‡∏°‡∏ä‡∏µ‡∏™", category: "cat-1b", source: "Social" },
            { id: 45, name: "‡∏™‡∏±‡∏á‡∏Ç‡∏¢‡∏≤‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢", category: "cat-1b", source: "Social" },
            { id: 46, name: "Dial-in Espresso / ‡∏Å‡∏≤‡∏£‡∏ä‡∏á‡∏Å‡∏≤‡πÅ‡∏ü", category: "cat-1c", source: "‡∏™‡∏Å‡∏£." },
            { id: 47, name: "Latte Art ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "cat-1c", source: "‡∏™‡∏Å‡∏£." },
            { id: 48, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏≤‡πÅ‡∏ü‡∏£‡πâ‡∏≠‡∏ô-‡πÄ‡∏¢‡πá‡∏ô-‡∏õ‡∏±‡πà‡∏ô", category: "cat-1c", source: "‡∏™‡∏Å‡∏£." },
            { id: 49, name: "‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏ô‡∏π Signature Drink", category: "cat-1c", source: "‡∏™‡∏Å‡∏£." },
            { id: 50, name: "‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ Specialty", category: "cat-1c", source: "Social" },
            { id: 51, name: "‡∏ä‡∏≤‡∏ô‡∏°‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å", category: "cat-1c", source: "Social" },
            { id: 52, name: "‡∏°‡∏±‡∏ó‡∏â‡∏∞/‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏ô‡∏°", category: "cat-1c", source: "Social" },
            { id: 53, name: "‡∏ô‡πâ‡∏≥‡∏•‡∏≥‡πÑ‡∏¢‡∏´‡∏°‡πâ‡∏≠‡πÉ‡∏´‡∏ç‡πà", category: "cat-1c", source: "Social" },
            { id: 54, name: "Cold Brew / ‡∏Å‡∏≤‡πÅ‡∏ü‡∏™‡∏Å‡∏±‡∏î‡πÄ‡∏¢‡πá‡∏ô", category: "cat-1c", source: "Social" },
            { id: 55, name: "‡∏™‡∏°‡∏π‡∏ó‡∏ï‡∏µ‡πâ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏£‡πâ‡∏≤‡∏ô‡∏î‡∏±‡∏á", category: "cat-1c", source: "Social" },
            { id: 56, name: "‡∏ä‡∏≤‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏à‡∏µ‡∏ô", category: "cat-1c", source: "Social" },
            { id: 57, name: "‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏ß‡∏î‡πÑ‡∏ó‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 58, name: "‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤)", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 59, name: "‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 60, name: "‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 61, name: "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 62, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 63, name: "‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏•‡∏≤‡∏¢‡∏ö‡∏≤‡∏ï‡∏¥‡∏Å", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 64, name: "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏•‡∏ß‡∏î‡∏•‡∏≤‡∏¢‡∏£‡πà‡∏ß‡∏°‡∏™‡∏°‡∏±‡∏¢", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 65, name: "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏û‡∏ó‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏ä‡∏∏‡∏î‡∏ú‡πâ‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏ö‡∏ö‡∏£‡πà‡∏ß‡∏°‡∏™‡∏°‡∏±‡∏¢", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 66, name: "‡∏Å‡∏≤‡∏£‡∏°‡∏±‡∏î‡∏•‡∏≤‡∏¢‡∏°‡∏±‡∏î‡∏´‡∏°‡∏µ‡πà", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 67, name: "‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏±‡∏Å‡∏õ‡∏•‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏∞‡∏õ‡∏¥", category: "cat-2a", source: "‡∏™‡∏Å‡∏£." },
            { id: 68, name: "‡πÑ‡∏£‡πÄ‡∏î‡∏≠‡∏£‡πå Grab/Bolt/Robinhood", category: "cat-2b", source: "Social" },
            { id: 69, name: "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", category: "cat-2b", source: "Social" },
            { id: 70, name: "‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏ô‡πà‡∏≤‡∏ó‡∏≤‡∏ô", category: "cat-2b", source: "Social" },
            { id: 71, name: "‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô Shopee", category: "cat-3", source: "Social" },
            { id: 72, name: "‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô Lazada", category: "cat-3", source: "Social" },
            { id: 73, name: "‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô Facebook Marketplace", category: "cat-3", source: "Social" },
            { id: 74, name: "TikTok Shop / ‡∏õ‡∏±‡∏Å‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤", category: "cat-3", source: "Social" },
            { id: 75, name: "Shopee Affiliate", category: "cat-3", source: "Social" },
            { id: 76, name: "Lazada Affiliate", category: "cat-3", source: "Social" },
            { id: 77, name: "Admin ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå / ‡∏£‡∏±‡∏ö‡∏ï‡∏≠‡∏ö‡πÅ‡∏ä‡∏ó", category: "cat-3", source: "Social" },
            { id: 78, name: "‡πÑ‡∏•‡∏ü‡πå‡∏™‡∏î TikTok ‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á", category: "cat-3", source: "Social" },
            { id: 79, name: "‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á Facebook", category: "cat-3", source: "Social" },
            { id: 80, name: "Dropshipping ‡∏à‡∏≤‡∏Å‡∏à‡∏µ‡∏ô", category: "cat-3", source: "Social" },
            { id: 81, name: "‡∏ô‡∏≥‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏≤‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå", category: "cat-3", source: "Social" },
            { id: 82, name: "YouTube Channel ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", category: "cat-3", source: "Social" },
            { id: 83, name: "‡πÄ‡∏õ‡πá‡∏ô Influencer ‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà", category: "cat-3", source: "Social" },
            { id: 84, name: "AI ‡∏ä‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏® (ChatGPT/Claude/Gemini)", category: "cat-4a", source: "Social" },
            { id: 85, name: "AI ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô", category: "cat-4a", source: "Social" },
            { id: 86, name: "AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå / ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°", category: "cat-4a", source: "Social" },
            { id: 87, name: "AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û (Image Generator)", category: "cat-4a", source: "Social" },
            { id: 88, name: "AI ‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠", category: "cat-4a", source: "Social" },
            { id: 89, name: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏õ‡∏•‡∏†‡∏≤‡∏©‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥", category: "cat-4a", source: "Social" },
            { id: 90, name: "AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠ (Presentation)", category: "cat-4a", source: "Social" },
            { id: 91, name: "‡∏ó‡∏≥‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•", category: "cat-4a", source: "Social" },
            { id: 92, name: "‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î", category: "cat-4b", source: "Social" },
            { id: 93, name: "‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ ‡∏´‡πà‡∏≤‡∏á‡πÑ‡∏Å‡∏•‡πÇ‡∏£‡∏Ñ", category: "cat-4b", source: "Social" },
            { id: 94, name: "‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ñ‡∏π‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á‡∏¢‡∏≤", category: "cat-4b", source: "Social" },
            { id: 95, name: "Meal Prep - ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 30 ‡∏ß‡∏±‡∏ô ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢", category: "cat-4b", source: "Social" },
            { id: 96, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ‡∏ô‡∏≤‡∏ô (‡∏ú‡∏±‡∏Å ‡∏ú‡∏•‡πÑ‡∏°‡πâ ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå)", category: "cat-4b", source: "Social" },
            { id: 97, name: "‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡∏™‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡∏ß (‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤ ‡πÇ‡∏´‡∏£‡∏∞‡∏û‡∏≤ ‡∏ú‡∏±‡∏Å‡∏ä‡∏µ ‡∏û‡∏£‡∏¥‡∏Å)", category: "cat-5", source: "Social" },
            { id: 98, name: "‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡∏Å‡∏¥‡∏ô‡πÉ‡∏ö (‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á ‡∏Ñ‡∏∞‡∏ô‡πâ‡∏≤ ‡∏Å‡∏ß‡∏≤‡∏á‡∏ï‡∏∏‡πâ‡∏á)", category: "cat-5", source: "Social" },
            { id: 99, name: "‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡∏Å‡∏¥‡∏ô‡∏ú‡∏• (‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠ ‡πÅ‡∏ï‡∏á‡∏Å‡∏ß‡∏≤ ‡∏ñ‡∏±‡πà‡∏ß‡∏ù‡∏±‡∏Å‡∏¢‡∏≤‡∏ß)", category: "cat-5", source: "Social" },
            { id: 100, name: "‡∏õ‡∏•‡∏π‡∏Å‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠‡πÄ‡∏ó‡∏®‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á", category: "cat-5", source: "Social" },
            { id: 101, name: "‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡πâ‡∏ô‡∏´‡∏≠‡∏° ‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏° ‡∏Ç‡∏¥‡∏á ‡∏Ç‡πà‡∏≤ ‡∏ï‡∏∞‡πÑ‡∏Ñ‡∏£‡πâ", category: "cat-5", source: "Social" },
            { id: 102, name: "‡πÄ‡∏û‡∏≤‡∏∞‡∏ñ‡∏±‡πà‡∏ß‡∏á‡∏≠‡∏Å‡∏Å‡∏¥‡∏ô‡πÄ‡∏≠‡∏á", category: "cat-5", source: "Social" },
            { id: 103, name: "‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡πÇ‡∏õ‡∏ô‡∏¥‡∏Å‡∏™‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "cat-5", source: "Social" },
            { id: 104, name: "‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ö‡∏ô GrabFood ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ß‡∏ö‡πâ‡∏≤‡∏ô/‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î", category: "cat-6", source: "Social" },
            { id: 105, name: "‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ö‡∏ô LINE MAN ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ß‡∏ö‡πâ‡∏≤‡∏ô/‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î", category: "cat-6", source: "Social" },
            { id: 106, name: "‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ", category: "cat-6", source: "Social" },
            { id: 107, name: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ", category: "cat-6", source: "Social" },
            { id: 108, name: "‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡∏î‡∏π‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠", category: "cat-6", source: "Social" },
            { id: 109, name: "‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡πÉ‡∏´‡πâ‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏±‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏ô‡∏™‡πà‡∏á", category: "cat-6", source: "Social" },
            { id: 110, name: "‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≥‡πÑ‡∏£‡πÅ‡∏°‡πâ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ GP", category: "cat-6", source: "Social" },
            { id: 111, name: "‡∏ß‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å", category: "cat-6", source: "Social" },
            { id: 112, name: "‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô TikTok Shop", category: "cat-7", source: "Social" },
            { id: 113, name: "TikTok Affiliate ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", category: "cat-7", source: "Social" },
            { id: 114, name: "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÑ‡∏•‡∏ü‡πå‡∏™‡∏î TikTok (‡∏ï‡∏≠‡∏ô 1) - ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡πÄ‡∏ß‡∏•‡∏≤", category: "cat-7", source: "Social" },
            { id: 115, name: "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÑ‡∏•‡∏ü‡πå‡∏™‡∏î TikTok (‡∏ï‡∏≠‡∏ô 2) - ‡∏î‡∏∂‡∏á‡∏Ñ‡∏ô‡∏î‡∏π ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢", category: "cat-7", source: "Social" },
            { id: 116, name: "‡∏™‡∏£‡πâ‡∏≤‡∏á Content TikTok ‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏∂‡πâ‡∏ô", category: "cat-7", source: "Social" },
            { id: 117, name: "LINE OA / LINE MyShop ‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á", category: "cat-7", source: "Social" },
            { id: 118, name: "‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô Instagram", category: "cat-7", source: "Social" },
            { id: 119, name: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô Google Maps ‡∏î‡πâ‡∏ß‡∏¢ Google Business Profile", category: "cat-8", source: "Social" },
            { id: 120, name: "‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏£‡πâ‡∏≤‡∏ô‡πÉ‡∏ô Google Maps ‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏à‡∏≠‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏î‡∏µ", category: "cat-8", source: "Social" },
            { id: 121, name: "‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏° Facebook ‡∏¢‡πà‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô‡πÅ‡∏ö‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ó‡∏±‡∏Å‡∏ã‡∏∑‡πâ‡∏≠", category: "cat-8", source: "Social" },
            { id: 122, name: "Facebook Ads ‡∏¢‡∏¥‡∏á‡πÅ‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á (‡∏ï‡∏≠‡∏ô 1) - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤", category: "cat-8", source: "Social" },
            { id: 123, name: "Facebook Ads ‡∏¢‡∏¥‡∏á‡πÅ‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á (‡∏ï‡∏≠‡∏ô 2) - ‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö ‡∏ß‡∏±‡∏î‡∏ú‡∏•", category: "cat-8", source: "Social" },
            { id: 124, name: "‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î/‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô", category: "cat-8", source: "Social" },
            { id: 125, name: "‡πÉ‡∏ä‡πâ Google Gemini ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡∏≤‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®", category: "cat-9", source: "Social" },
            { id: 126, name: "Microsoft Copilot ‡∏ä‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®", category: "cat-9", source: "Social" },
            { id: 127, name: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö AI (GEO)", category: "cat-9", source: "Social" },
            { id: 128, name: "‡∏ó‡∏±‡∏Å‡∏©‡∏∞ Admin ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ä‡∏ó‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤", category: "cat-10", source: "Social" },
            { id: 129, name: "‡∏á‡∏≤‡∏ô Call Center ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "cat-10", source: "Social" },
            { id: 130, name: "‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (UGC Creator)", category: "cat-10", source: "Social" },
            { id: 131, name: "‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏™‡∏±‡πâ‡∏ô‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á", category: "cat-10", source: "Social" },
            { id: 132, name: "‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢‡πÑ‡∏õ‡∏à‡∏µ‡∏ô‡∏ú‡πà‡∏≤‡∏ô Douyin", category: "cat-11", source: "Social" },
            { id: 133, name: "‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô‡∏ö‡∏ô Taobao / Tmall Global", category: "cat-11", source: "Social" }
        ];

        const categoryInfo = {
            'cat-1a': { name: 'üçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏≤‡∏ß', header: 'cat-1a' },
            'cat-1a-np': { name: 'üå∂Ô∏è ‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏¥‡πâ‡∏°', header: 'cat-1a-np' },
            'cat-1a-jd': { name: 'üçõ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß', header: 'cat-1a-jd' },
            'cat-1b': { name: 'üç∞ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ß‡πà‡∏≤‡∏á', header: 'cat-1b' },
            'cat-1c': { name: '‚òï ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', header: 'cat-1c' },
            'cat-2a': { name: 'üíº ‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏´‡∏°‡∏ß‡∏î ‡∏™‡∏Å‡∏£.', header: 'cat-2a' },
            'cat-2b': { name: 'üö¥ ‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏≠‡∏¥‡∏™‡∏£‡∏∞', header: 'cat-2b' },
            'cat-3': { name: 'üõí ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå', header: 'cat-3' },
            'cat-4a': { name: 'ü§ñ ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏ô‡πÄ‡∏≠‡∏á/AI', header: 'cat-4a' },
            'cat-4b': { name: 'üí™ ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢', header: 'cat-4b' },
            'cat-5': { name: 'üå± ‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡∏ô', header: 'cat-5' },
            'cat-6': { name: 'üöö ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ Delivery', header: 'cat-6' },
            'cat-7': { name: 'üì± TikTok ‡πÅ‡∏•‡∏∞ Social Commerce', header: 'cat-7' },
            'cat-8': { name: 'üîç Google ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå', header: 'cat-8' },
            'cat-9': { name: 'ü§ñ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', header: 'cat-9' },
            'cat-10': { name: 'üíº ‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå', header: 'cat-10' },
            'cat-11': { name: 'üåè ‡∏Ç‡∏≤‡∏¢‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®', header: 'cat-11' }
        };

        const categoryOrder = ['cat-1a', 'cat-1a-np', 'cat-1a-jd', 'cat-1b', 'cat-1c', 'cat-2a', 'cat-2b', 'cat-3', 'cat-4a', 'cat-4b', 'cat-5', 'cat-6', 'cat-7', 'cat-8', 'cat-9', 'cat-10', 'cat-11'];

        let rankings = new Array(20).fill(null);
        let currentCategory = 'all';
        let searchQuery = '';
        let customCourses = [];
        let allCourses = [...courses];
        let submittedCenters = new Set();

        const leftSidebar = document.getElementById('leftSidebar');
        const courseListContainer = document.getElementById('courseListContainer');
        const rankingList = document.getElementById('rankingList');
        const searchInput = document.getElementById('searchInput');
        const selectedCountEl = document.getElementById('selectedCount');
        const collapsedInfo = document.getElementById('collapsedInfo');
        const btnSubmit = document.getElementById('btnSubmit');
        const toast = document.getElementById('toast');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const modalOverlay = document.getElementById('modalOverlay');
        const filterScroll = document.getElementById('filterScroll');
        const tooltip = document.getElementById('tooltip');

        function init() {
            renderRankings();
            renderCourses();
            setupEventListeners();
            fetchSubmittedCenters();
        }

        async function fetchSubmittedCenters() {
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') return;
            try {
                const res = await fetch(GOOGLE_SCRIPT_URL);
                const data = await res.json();
                if (data.submittedCenters && Array.isArray(data.submittedCenters)) {
                    submittedCenters = new Set(data.submittedCenters);
                }
            } catch (e) { /* ‡πÑ‡∏°‡πà‡∏ö‡∏•‡πá‡∏≠‡∏Ñ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ */ }
        }

        function renderRankings() {
            rankingList.innerHTML = '';
            for (let i = 0; i < 20; i++) {
                const slot = document.createElement('div');
                slot.className = `ranking-slot ${rankings[i] ? 'filled' : ''}`;
                slot.draggable = true;
                const course = rankings[i] ? allCourses.find(c => c.id === rankings[i]) : null;
                const displayName = course ? (course.name.length > 18 ? course.name.substring(0, 16) + '...' : course.name) : '‡∏ß‡πà‡∏≤‡∏á';

                slot.innerHTML = `
                    <div class="ranking-number">${i + 1}</div>
                    <div class="ranking-content" title="${course ? course.name : ''}">${displayName}</div>
                    ${course ? '<button class="ranking-remove">‚úï</button>' : ''}
                `;

                slot.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', JSON.stringify({ fromRank: i + 1 }));
                });

                slot.addEventListener('dragover', (e) => { e.preventDefault(); slot.classList.add('drag-over'); });
                slot.addEventListener('dragleave', () => slot.classList.remove('drag-over'));

                slot.addEventListener('drop', (e) => {
                    e.preventDefault();
                    slot.classList.remove('drag-over');
                    try {
                        const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                        if (data.fromRank) {
                            const fromIdx = data.fromRank - 1;
                            const temp = rankings[fromIdx];
                            rankings[fromIdx] = rankings[i];
                            rankings[i] = temp;
                            updateUI();
                        } else if (data.courseId) {
                            selectRank(data.courseId, i + 1);
                        }
                    } catch (err) {}
                });

                const removeBtn = slot.querySelector('.ranking-remove');
                if (removeBtn) {
                    removeBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const courseId = rankings[i];
                        if (courseId >= 1000) {
                            customCourses = customCourses.filter(c => c.id !== courseId);
                            allCourses = allCourses.filter(c => c.id !== courseId);
                            const idx = courseId - 1000;
                            const input = document.querySelector(`[data-custom-id="c${idx + 1}"]`);
                            if (input) input.value = '';
                        }
                        rankings[i] = null;
                        updateUI();
                        showToast('‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß');
                    });
                }

                rankingList.appendChild(slot);
            }
        }

        function smartSearch(query, text) {
            const q = query.toLowerCase().trim();
            const t = text.toLowerCase();
            if (t.includes(q)) return true;
            for (const [alias, target] of Object.entries(searchAliases)) {
                if (q.includes(alias) || alias.includes(q)) {
                    if (t.includes(target) || t.includes(alias)) return true;
                }
            }
            return false;
        }

        function renderCourses() {
            courseListContainer.innerHTML = '';
            let filtered = allCourses.filter(c => {
                const matchCategory = currentCategory === 'all' || c.category === currentCategory;
                const matchSearch = searchQuery === '' || smartSearch(searchQuery, c.name);
                return matchCategory && matchSearch;
            });

            const grouped = {};
            filtered.forEach(course => {
                if (!grouped[course.category]) grouped[course.category] = [];
                grouped[course.category].push(course);
            });

            categoryOrder.forEach(cat => {
                if (grouped[cat] && grouped[cat].length > 0) {
                    const section = document.createElement('div');
                    section.className = 'category-section';

                    const header = document.createElement('div');
                    header.className = `category-header ${categoryInfo[cat].header}`;
                    header.textContent = categoryInfo[cat].name;
                    section.appendChild(header);

                    const grid = document.createElement('div');
                    grid.className = 'course-grid';

                    grouped[cat].forEach(course => {
                        const rankIndex = rankings.indexOf(course.id);
                        const isSelected = rankIndex !== -1;

                        const card = document.createElement('div');
                        card.className = `course-card ${isSelected ? 'selected' : ''}`;
                        card.draggable = true;
                        if (isSelected) card.dataset.rank = `#${rankIndex + 1}`;

                        let options = '<option value="">-</option>';
                        for (let i = 1; i <= 20; i++) {
                            const sel = (isSelected && rankIndex + 1 === i) ? 'selected' : '';
                            options += `<option value="${i}" ${sel}>${i}</option>`;
                        }

                        const sourceClass = course.source === '‡∏™‡∏Å‡∏£.' ? 'skr' : 'social';
                        const sourceLabel = course.source === '‡∏™‡∏Å‡∏£.' ? '‡∏™‡∏Å‡∏£.' : 'Social';
                        const shortName = course.name.length > 20 ? course.name.substring(0, 18) + '...' : course.name;

                        card.innerHTML = `
                            <div class="course-id">${course.id}<span class="source-tag ${sourceClass}">${sourceLabel}</span></div>
                            <div class="course-name">${shortName}</div>
                            <select class="rank-dropdown">${options}</select>
                        `;

                        card.addEventListener('mouseenter', (e) => {
                            tooltip.textContent = `${course.name} (${sourceLabel})`;
                            tooltip.classList.add('show');
                            const rect = card.getBoundingClientRect();
                            tooltip.style.left = rect.left + 'px';
                            tooltip.style.top = (rect.top - 30) + 'px';
                        });
                        card.addEventListener('mouseleave', () => tooltip.classList.remove('show'));

                        card.addEventListener('dragstart', (e) => {
                            e.dataTransfer.setData('text/plain', JSON.stringify({ courseId: course.id }));
                        });

                        const select = card.querySelector('.rank-dropdown');
                        select.addEventListener('change', (e) => {
                            e.stopPropagation();
                            const rank = parseInt(e.target.value);
                            if (rank) selectRank(course.id, rank);
                            else {
                                const idx = rankings.indexOf(course.id);
                                if (idx !== -1) { rankings[idx] = null; updateUI(); }
                            }
                        });
                        select.addEventListener('click', e => e.stopPropagation());
                        card.addEventListener('click', () => toggleSelection(course.id));

                        grid.appendChild(card);
                    });

                    section.appendChild(grid);
                    courseListContainer.appendChild(section);
                }
            });
        }

        function selectRank(courseId, rank) {
            const targetIndex = rank - 1;
            const existingIndex = rankings.indexOf(courseId);
            if (existingIndex !== -1) {
                const temp = rankings[targetIndex];
                rankings[targetIndex] = courseId;
                rankings[existingIndex] = temp;
            } else {
                rankings[targetIndex] = courseId;
            }
            updateUI();
            showToast(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${rank}`, 'success');
        }

        function toggleSelection(courseId) {
            const idx = rankings.indexOf(courseId);
            if (idx !== -1) {
                if (courseId >= 1000) {
                    customCourses = customCourses.filter(c => c.id !== courseId);
                    allCourses = allCourses.filter(c => c.id !== courseId);
                    const inputIdx = courseId - 1000;
                    const input = document.querySelector(`[data-custom-id="c${inputIdx + 1}"]`);
                    if (input) input.value = '';
                }
                rankings[idx] = null;
                updateUI();
                showToast('‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß');
            } else {
                const emptyIdx = rankings.findIndex(r => r === null);
                if (emptyIdx !== -1) {
                    rankings[emptyIdx] = courseId;
                    updateUI();
                    showToast(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${emptyIdx + 1}`, 'success');
                } else {
                    showToast('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏£‡∏ö 20 ‡πÅ‡∏•‡πâ‡∏ß!', 'warning');
                }
            }
        }

        function updateUI() {
            renderRankings();
            renderCourses();
            const count = rankings.filter(r => r !== null).length;
            selectedCountEl.textContent = count;
            collapsedInfo.textContent = `${count}/20`;
            btnSubmit.disabled = count < 20;
        }

        function showToast(msg, type = '') {
            toast.textContent = msg;
            toast.className = `toast ${type} show`;
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        function setupEventListeners() {
            searchInput.addEventListener('input', (e) => { searchQuery = e.target.value; renderCourses(); });

            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentCategory = tab.dataset.category;
                    renderCourses();
                });
            });

            document.getElementById('scrollLeft').addEventListener('click', () => filterScroll.scrollBy({ left: -150, behavior: 'smooth' }));
            document.getElementById('scrollRight').addEventListener('click', () => filterScroll.scrollBy({ left: 150, behavior: 'smooth' }));

            document.getElementById('sidebarToggle').addEventListener('click', () => leftSidebar.classList.toggle('collapsed'));

            document.getElementById('viewNormal').addEventListener('click', () => {
                document.getElementById('viewNormal').classList.add('active');
                document.getElementById('viewCompact').classList.remove('active');
                document.body.classList.remove('compact-mode');
            });
            document.getElementById('viewCompact').addEventListener('click', () => {
                document.getElementById('viewCompact').classList.add('active');
                document.getElementById('viewNormal').classList.remove('active');
                document.body.classList.add('compact-mode');
            });

            document.getElementById('addCourseBtn').addEventListener('click', () => {
                document.querySelectorAll('[data-custom-id]').forEach((input, idx) => {
                    const existingCourse = customCourses.find(c => c.id === 1000 + idx);
                    input.value = existingCourse ? existingCourse.name : '';
                    input.classList.remove('error');
                });
                modalOverlay.classList.add('show');
            });
            document.getElementById('modalClose').addEventListener('click', () => modalOverlay.classList.remove('show'));
            document.getElementById('modalCancel').addEventListener('click', () => modalOverlay.classList.remove('show'));
            document.getElementById('modalSave').addEventListener('click', saveCustomCourses);

            document.getElementById('btnClear').addEventListener('click', () => {
                rankings = new Array(20).fill(null);
                document.querySelectorAll('[data-custom-id]').forEach(input => { input.value = ''; input.classList.remove('error'); });
                customCourses = [];
                allCourses = [...courses];
                updateUI();
                showToast('‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
            });

            btnSubmit.addEventListener('click', handleSubmit);
        }

        function saveCustomCourses() {
            let hasError = false;
            const newNames = [];
            const inputs = document.querySelectorAll('[data-custom-id]');

            inputs.forEach((input) => {
                input.classList.remove('error');
                const name = input.value.trim();
                if (name) {
                    if (newNames.includes(name.toLowerCase())) {
                        input.classList.add('error');
                        hasError = true;
                        showToast('‡∏ß‡∏¥‡∏ä‡∏≤‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô!', 'error');
                        return;
                    }
                    const existsInMain = courses.some(c => c.name.toLowerCase() === name.toLowerCase());
                    if (existsInMain) {
                        input.classList.add('error');
                        hasError = true;
                        showToast(`"${name}" ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß`, 'error');
                        return;
                    }
                    newNames.push(name.toLowerCase());
                }
            });

            if (hasError) return;

            customCourses.forEach(cc => {
                const idx = rankings.indexOf(cc.id);
                if (idx !== -1) rankings[idx] = null;
            });

            allCourses = [...courses];
            customCourses = [];

            inputs.forEach((input, idx) => {
                const name = input.value.trim();
                if (name) {
                    const customId = 1000 + idx;
                    const newCourse = { id: customId, name, category: 'custom', source: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏á' };
                    customCourses.push(newCourse);
                    allCourses.push(newCourse);
                    const emptyIdx = rankings.findIndex(r => r === null);
                    if (emptyIdx !== -1) rankings[emptyIdx] = customId;
                }
            });

            modalOverlay.classList.remove('show');
            updateUI();
            if (customCourses.length > 0) showToast(`‡πÄ‡∏û‡∏¥‡πà‡∏° ${customCourses.length} ‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡πâ‡∏ß`, 'success');
            else showToast('‡∏•‡πâ‡∏≤‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß');
        }

        async function handleSubmit() {
            const center = document.getElementById('centerSearch').value.trim();
            if (!center) { showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°', 'warning'); return; }
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') { showToast('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL', 'error'); return; }
            if (submittedCenters.has(center)) { showToast('‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ô‡∏µ‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß!', 'error'); return; }

            const timestamp = new Date().toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' });
            const formData = { timestamp, center, totalSelected: rankings.filter(r => r !== null).length };

            for (let i = 0; i < 20; i++) {
                const course = rankings[i] ? allCourses.find(c => c.id === rankings[i]) : null;
                formData[`rank${i + 1}`] = course ? course.name : '';
            }
            for (let i = 0; i < 5; i++) formData[`customCourse${i + 1}`] = customCourses[i]?.name || '';

            loadingOverlay.classList.add('show');
            btnSubmit.disabled = true;

            try {
                await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) });
                loadingOverlay.classList.remove('show');
                showToast('‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ', 'success');
                submittedCenters.add(center);
                setTimeout(() => {
                    rankings = new Array(20).fill(null);
                    document.getElementById('centerSearch').value = '';
                    document.querySelectorAll('[data-custom-id]').forEach(input => input.value = '');
                    customCourses = [];
                    allCourses = [...courses];
                    updateUI();
                }, 2000);
            } catch (error) {
                loadingOverlay.classList.remove('show');
                btnSubmit.disabled = false;
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'error');
            }
        }

        init();
    </script>
</body>
</html>
